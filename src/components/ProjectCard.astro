---
export interface Props {
  title: string;
  description: string;
  tags: string[];
  githubUrl?: string;
  demoUrl?: string;
  featured?: boolean;
}

const { title, description, tags, githubUrl, demoUrl, featured = false } = Astro.props;

function getTagColorAndGlow(tag: string): string {
  const lowerTag = tag.toLowerCase();

  if (
    ["c", "rust", "python", "javascript", "typescript", "c++", "java", "go", "ruby", "swift"].some(
      (lang) => lowerTag.includes(lang)
    )
  ) {
    return "text-term-bright-green border-term-bright-green hover:glow-bright-green";
  }

  if (
    ["react", "vue", "angular", "next", "astro", "svelte", "django", "flask", "express", "qt"].some(
      (fw) => lowerTag.includes(fw)
    )
  ) {
    return "text-term-bright-cyan border-term-bright-cyan hover:glow-bright-cyan";
  }

  if (
    ["kernel", "driver", "embedded", "linux", "aosp", "rom", "bsp", "bootloader"].some((sys) =>
      lowerTag.includes(sys)
    )
  ) {
    return "text-term-bright-red border-term-bright-red hover:glow-bright-red";
  }

  if (
    ["docker", "kubernetes", "git", "ci/cd", "jenkins", "qemu", "yocto", "buildroot"].some((tool) =>
      lowerTag.includes(tool)
    )
  ) {
    return "text-term-bright-magenta border-term-bright-magenta hover:glow-bright-magenta";
  }

  if (
    ["mongodb", "postgres", "mysql", "redis", "sqlite", "database", "sql"].some((db) =>
      lowerTag.includes(db)
    )
  ) {
    return "text-term-bright-yellow border-term-bright-yellow hover:glow-bright-yellow";
  }

  return "text-term-bright-blue border-term-bright-blue hover:glow-bright-blue";
}
---

<div
  class:list={[
    "project-card-container mb-6 border p-4 transition-all duration-300 hover:border-primary max-sm:p-3",
    { "border-l-[3px] border-l-primary": featured },
  ]}
>
  <div class="mb-3 flex items-start justify-between">
    <h3 class="text-lg font-bold text-terminal font-ui-heading max-sm:text-base">
      <span class="mr-2 text-primary font-ui-prompt">&gt;</span>
      {title}
    </h3>
    {featured && <span class="bg-primary px-2 py-1 text-black font-ui-badge">Featured</span>}
  </div>

  <p class="mb-4 text-sm leading-relaxed text-terminal-secondary font-content">{description}</p>

  <div class="mb-4 flex flex-wrap gap-2">
    {
      tags.map((tag) => (
        <span
          class:list={`border px-2 py-1 transition-all duration-200 font-ui-badge hover:scale-105 ${getTagColorAndGlow(tag)}`}
          style="background: rgba(var(--bg-color-rgb), 0.06); backdrop-filter: blur(4px); -webkit-backdrop-filter: blur(4px); box-shadow: 0 1px 3px rgba(0, 0, 0, 0.02), inset 0 1px 0 rgba(255, 255, 255, 0.01);"
        >
          {tag}
        </span>
      ))
    }
  </div>

  <div class="flex gap-4">
    {
      githubUrl && (
        <a
          href={githubUrl}
          target="_blank"
          rel="noopener noreferrer"
          class="glitch-subtle-hover text-sm text-term-bright-green no-underline transition-all duration-200 font-ui-interactive hover:text-term-bright-cyan hover:underline hover:glow-bright-cyan"
        >
          <span class="text-term-bright-black">[</span>
          GitHub
          <span class="text-term-bright-black">]</span>
        </a>
      )
    }
    {
      demoUrl && (
        <a
          href={demoUrl}
          target="_blank"
          rel="noopener noreferrer"
          class="glitch-subtle-hover text-sm text-term-bright-magenta no-underline transition-all duration-200 font-ui-interactive hover:text-term-bright-cyan hover:underline hover:glow-bright-cyan"
        >
          <span class="text-term-bright-black">[</span>
          Demo
          <span class="text-term-bright-black">]</span>
        </a>
      )
    }
  </div>
</div>

<style>
  .project-card-container {
    background: rgba(var(--bg-color-rgb), 0.05);
    backdrop-filter: blur(8px) saturate(1.1);
    -webkit-backdrop-filter: blur(8px) saturate(1.1);
    border-color: rgba(var(--border-color-rgb), 0.5);
    box-shadow:
      0 2px 6px rgba(0, 0, 0, 0.04),
      inset 0 1px 0 rgba(255, 255, 255, 0.02);
  }

  .project-card-container:hover {
    background: rgba(var(--bg-color-rgb), 0.08);
    backdrop-filter: blur(10px) saturate(1.2);
    -webkit-backdrop-filter: blur(10px) saturate(1.2);
    box-shadow:
      0 0 8px rgba(var(--border-color-rgb), 0.2),
      0 4px 12px rgba(0, 0, 0, 0.06),
      inset 0 1px 0 rgba(255, 255, 255, 0.04);
  }
</style>
