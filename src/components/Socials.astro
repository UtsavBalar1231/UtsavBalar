---
import SocialIcon from "./SocialIcon.astro";
import { socials } from "../data/socials";
---

<!-- Start: Social Links -->
<div class="social-links-grid xs:gap-2.5 mt-4 grid grid-cols-4 gap-2 sm:gap-3 md:gap-4">
  {
    socials.map((social) => (
      <a
        href={social.link}
        target="_blank"
        title={social.title}
        aria-label={social.title}
        rel="noopener noreferrer"
        class="social-link glitch-icon-hover flex h-12 w-12 items-center justify-center border-2 p-2 transition-all duration-300 hover:shadow-md sm:h-14 sm:w-14 sm:p-2.5 md:h-16 md:w-16 md:p-3"
        onclick={social.onClick}
      >
        <SocialIcon icon={social.icon} />
      </a>
    ))
  }
</div>
<!-- End: Social Links -->

<style>
  /* Responsive grid for very small screens */
  @media (max-width: 360px) {
    .social-links-grid {
      grid-template-columns: repeat(3, 1fr) !important;
    }
  }

  .social-link {
    background-color: var(--bg-primary);
    color: var(--text-primary);
    border-color: var(--border-color);
    position: relative;
    overflow: hidden;
  }

  .social-link::before,
  .social-link::after {
    content: "";
    position: absolute;
    width: 0;
    height: 2px;
    background: var(--accent-primary);
    transition: width 0.3s ease;
  }

  .social-link::before {
    top: 0;
    left: 0;
  }

  .social-link::after {
    bottom: 0;
    right: 0;
  }

  .social-link:hover::before,
  .social-link:hover::after {
    width: 100%;
  }

  .social-link:hover {
    background-color: var(--accent-primary);
    border-color: var(--accent-primary);
    color: var(--bg-primary);
    box-shadow:
      0 8px 24px rgba(0, 0, 0, 0.2),
      0 0 15px rgba(var(--accent-rgb), 0.15);
  }

  .social-link:active {
    transform: scale(0.98);
  }
</style>

<script>
  // Make sure the refreshCatImage function is available in the global scope
  if (typeof window.refreshCatImage !== "function") {
    window.refreshCatImage = () => {
      const avatarEl = document.getElementById("profile-avatar") as HTMLImageElement;
      if (avatarEl) {
        const random = Math.floor(Math.random() * 1000);
        const width = avatarEl.getAttribute("width");
        const height = avatarEl.getAttribute("height");
        avatarEl.src = `https://cataas.com/cat?width=${width}&height=${height}&s=${random}`;
      }
    };
  }
</script>
