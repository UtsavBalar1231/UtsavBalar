---
import SocialIcon from "./SocialIcon.astro";
import { socials } from "../data/socials";
---

<div
  class="social-links-grid mx-auto mt-4 grid max-w-xs grid-cols-4 place-items-center gap-3 sm:max-w-sm sm:gap-4 md:max-w-md md:gap-5"
>
  {
    socials.map((social) => (
      <a
        href={social.link}
        target="_blank"
        title={social.title}
        aria-label={social.title}
        rel="noopener noreferrer"
        class="social-link glitch-icon-hover flex aspect-square w-full max-w-[3rem] items-center justify-center border-2 p-2 transition-all duration-300 hover:shadow-md sm:max-w-[3.5rem] md:max-w-[4rem]"
        onclick={social.onClick}
      >
        <SocialIcon icon={social.icon} />
      </a>
    ))
  }
</div>

<style>
  @media (max-width: 360px) {
    .social-links-grid {
      grid-template-columns: repeat(3, 1fr) !important;
    }
  }

  @media (max-width: 320px) {
    .social-links-grid {
      grid-template-columns: repeat(2, 1fr) !important;
      gap: 1rem;
    }
  }

  .social-link {
    background: rgba(var(--bg-color-rgb), 0.08);
    backdrop-filter: blur(8px) saturate(1.1);
    color: var(--text-primary);
    border-color: rgba(var(--border-color-rgb), 0.5);
    position: relative;
    overflow: hidden;
    box-shadow:
      0 2px 8px rgba(0, 0, 0, 0.05),
      inset 0 1px 0 rgba(255, 255, 255, 0.02);
  }

  .social-link::before,
  .social-link::after {
    content: "";
    position: absolute;
    width: 0;
    height: 2px;
    background: var(--accent-primary);
    transition: width 0.3s ease;
  }

  .social-link::before {
    top: 0;
    left: 0;
  }

  .social-link::after {
    bottom: 0;
    right: 0;
  }

  .social-link:hover::before,
  .social-link:hover::after {
    width: 100%;
  }

  .social-link:hover {
    background: rgba(var(--bg-color-rgb), 0.15);
    backdrop-filter: blur(10px) saturate(1.2);
    border-color: var(--accent-primary);
    color: var(--accent-primary);
    box-shadow:
      0 8px 24px rgba(0, 0, 0, 0.1),
      0 0 15px rgba(var(--accent-rgb), 0.15),
      inset 0 1px 0 rgba(255, 255, 255, 0.04);
    transform: translateY(-2px);
  }

  .social-link:active {
    transform: scale(0.98);
  }
</style>

<script>
  if (typeof window.refreshCatImage !== "function") {
    window.refreshCatImage = () => {
      const avatarEl = document.getElementById("profile-avatar") as HTMLImageElement;
      if (avatarEl) {
        const random = Math.floor(Math.random() * 1000);
        const width = avatarEl.getAttribute("width");
        const height = avatarEl.getAttribute("height");
        avatarEl.src = `https://cataas.com/cat?width=${width}&height=${height}&s=${random}`;
      }
    };
  }
</script>
